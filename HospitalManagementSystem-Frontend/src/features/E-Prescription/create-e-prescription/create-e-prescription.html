<app-nav></app-nav>
<div class="min-h-screen bg-background-light dark:bg-background-dark px-4 py-8">
  <div class="max-w-3xl mx-auto">
    <div class="bg-white/80 dark:bg-white/5 backdrop-blur rounded-2xl shadow-xl border border-white/20 p-6">
      <h2 class="text-2xl font-semibold text-gray-900 dark:text-white">Create E-Prescription</h2>
      <p class="text-sm text-gray-600 dark:text-white/70 mt-1">Fill in the details and submit.</p>

      <form class="mt-6 space-y-4" [formGroup]="form" (ngSubmit)="submit()">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 dark:text-white/80">Doctor ID</label>
            <input class="input input-bordered w-full mt-1" formControlName="doctorId" placeholder="Loading..." readonly />
            <p class="text-xs text-gray-500 dark:text-white/60 mt-1" *ngIf="isLoadingDoctor()">Loading doctor...</p>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 dark:text-white/80">Patient ID <span class="text-red-500">*</span></label>
            <input class="input input-bordered w-full mt-1" formControlName="patientId" placeholder="Patient GUID" />
            <p class="text-xs text-red-600 mt-1" *ngIf="form.get('patientId')?.touched && form.get('patientId')?.invalid">Patient ID must be a valid GUID</p>
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-white/80">Visit Date <span class="text-red-500">*</span></label>
          <input type="date" class="input input-bordered w-full mt-1" formControlName="visitDate" />
          <p class="text-xs text-red-600 mt-1" *ngIf="form.get('visitDate')?.touched && form.get('visitDate')?.invalid">Visit date is required</p>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-white/80">Diagnosis <span class="text-red-500">*</span></label>
          <input class="input input-bordered w-full mt-1" formControlName="diagnosis" placeholder="Diagnosis" />
          <p class="text-xs text-red-600 mt-1" *ngIf="form.get('diagnosis')?.touched && form.get('diagnosis')?.invalid">Diagnosis is required</p>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-white/80">Prescription <span class="text-red-500">*</span></label>
          <textarea class="textarea textarea-bordered w-full mt-1" rows="4" formControlName="prescription" placeholder="Medicines, dosage, instructions"></textarea>
          <p class="text-xs text-red-600 mt-1" *ngIf="form.get('prescription')?.touched && form.get('prescription')?.invalid">Prescription is required</p>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 dark:text-white/80">Notes</label>
          <textarea class="textarea textarea-bordered w-full mt-1" rows="3" formControlName="notes" placeholder="Optional notes"></textarea>
        </div>

        <div class="flex justify-end gap-3 pt-2">
          <button type="submit" class="btn btn-primary" [disabled]="isSubmitting() || isLoadingDoctor()">
            <span *ngIf="!isSubmitting()">Create</span>
            <span *ngIf="isSubmitting()">Creating...</span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
